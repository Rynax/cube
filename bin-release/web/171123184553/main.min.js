var __reflect=this&&this.__reflect||function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,i){function r(r){t.call(i,r,e)}if(RES.hasRes(e)){var n=RES.getRes(e);n?r(n):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Cube;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="ResCubeSkin",t}return __extends(t,e),t.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t}(eui.Component);e.ResCube=t,__reflect(t.prototype,"Cube.ResCube",["eui.UIComponent","egret.DisplayObject"])}(Cube||(Cube={}));var Cube;!function(e){var t=function(t){function i(){var i=t.call(this)||this;i.b=[],i.shade_b=[],i.clevel=1,i.cscore=0,i.mult=1,i.patsrc=[],i.pattgt=[],i.timer=new egret.Timer(300,0),i.plex1=0,i.plex2=0,i.plex3=0,i.plex4=0,i.rx=0,i.ry=0,i.ax=0,i.ay=0,i.source=[null,null,null,null],i.slx=[],i.srx=[],i.sty=[],i.sby=[],i.cidx=3,i.cb=[],i.record=null,i.skinName="BaseSkin",i.percentWidth=100,i.percentHeight=100;var r=0,n=0;for(r=0;9>r;r++)for(i.b[r]=[],i.shade_b[r]=[],n=0;9>n;n++)i.b[r][n]=new e.ResCube,i.b[r][n].currentState="empty",i.b[r][n].top=4*(r+1)+66*r,i.b[r][n].left=4*(n+1)+66*n,i.base.addChild(i.b[r][n]),i.shade_b[r][n]=new e.ResCube,i.shade_b[r][n].currentState="match",i.shade_b[r][n].alpha=0,i.shade_b[r][n].top=4*(r+1)+66*r,i.shade_b[r][n].left=4*(n+1)+66*n,i.base.addChild(i.shade_b[r][n]);for(r=0;r<e.GlobalArg.patsrc.length;r++)i.patsrc[r]=new e.S(e.GlobalArg.patsrc[r]);for(r=0;r<e.GlobalArg.pattgt.length;r++)i.pattgt[r]=new e.T(e.GlobalArg.pattgt[r]);return i.timer.addEventListener(egret.TimerEvent.TIMER,i.erase_b_field_timer,i),i.timer.stop(),i.touch_on(),i}return __extends(i,t),i.prototype.show_top=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touch_begin,this),this.get_score(),this.top_shade.alpha=.5,this.top_bg.alpha=.9,this.top_head.alpha=1,this.top_msg.alpha=1,this.top_list.alpha=1,this.top_button.currentState="up",this.top_button.label="重新开始",this.top_button.alpha=1,this.top_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.restart,this)},i.prototype.get_score=function(){var e=new egret.HttpRequest;e.responseType=egret.HttpResponseType.TEXT,e.open("top.do",egret.HttpMethod.POST),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this)},i.prototype.onPostComplete=function(t){var i=t.currentTarget,r=JSON.parse(i.response);if("0"!=r.code)return void(this.top_msg.text=r.desc);var n=0;if(r.data.length>=10){var o=r.data[r.data.length-1].s;if(this.cscore<o/100)return void(this.top_msg.text="您的排名, 深不见底......");if(this.cscore<=o)return void(this.top_msg.text="差一点就能上榜了, 加油啊!");n=r.data.length-1}else n=r.data.length;this.top_msg.text="大神! 恭喜上榜! 快留个言BS一下下面那些智商欠费的渣渣!";var s=new eui.ArrayCollection;this.record=new e.Record;for(var h=0;h<r.data.length;h++)if(this.cscore>r.data[h].s){n=h;break}for(var h=0;n>h;h++)s.addItem({rank:r.data[h].r,name:r.data[h].n,level:r.data[h].l,score:r.data[h].s,desc:r.data[h].d});0!=n&&this.cscore==r.data[n-1].s?this.record.rank.text=r.data[n-1].r:this.record.rank.text=(n+1).toString(),this.record.level.text=this.level.text,this.record.score.text=this.score.text,this.record.top=110+70*n,this.top_group.addChild(this.record),s.addItem({rank:"",name:"",level:"",score:"",desc:""});for(var h=n;h<r.data.length-1-n;h++)s.addItem({rank:r.data[h].r+1,name:r.data[h].n,level:r.data[h].l,score:r.data[h].s,desc:r.data[h].d});this.top_list.dataProvider=s},i.prototype.onPostIOError=function(e){this.top_msg.text="连接服务器失败!"},i.prototype.onPostProgress=function(e){this.top_msg.text="连接服务器: "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%"},i.prototype.restart=function(){location.reload()},i.prototype.dp_new=function(e){var t=new eui.BitmapLabel;t.font=RES.getRes("cube_font_fnt"),t.width=600,t.height=80,t.scaleX=.3,t.scaleY=.3,t.textAlign="center",this.base.addChild(t),t.x=0,t.y=0,t.horizontalCenter=120,t.verticalCenter=0,t.text=e,egret.Tween.get(t).to({scaleX:1,scaleY:1,verticalCenter:-200},500,egret.Ease.sineIn).to({verticalCenter:-300,alpha:0},500,egret.Ease.sineIn).call(this.dp_del,t)},i.prototype.dp_del=function(){this.parent.removeChild(this)},i.prototype.set_source_field_once=function(e,t){this.slx[t]=e.localToGlobal().x,this.srx[t]=e.localToGlobal().x+e.width,this.sty[t]=e.localToGlobal().y,this.sby[t]=e.localToGlobal().y+e.height},i.prototype.set_source_field=function(){this.source1.numChildren>0&&(this.source[0]=this.source1.getChildAt(0),this.set_source_field_once(this.source[0],0)),this.source2.numChildren>0&&(this.source[1]=this.source2.getChildAt(0),this.set_source_field_once(this.source[1],1)),this.source3.numChildren>0&&(this.source[2]=this.source3.getChildAt(0),this.set_source_field_once(this.source[2],2))},i.prototype.release_source=function(e){switch(e){case 0:this.source1.removeChild(this.source[e]);break;case 1:this.source2.removeChild(this.source[e]);break;case 2:this.source3.removeChild(this.source[e]);break;default:return}this.source[e].includeInLayout=!1,this.source[e].b_size(),this.addChild(this.source[e])},i.prototype.insert_source=function(e){switch(this.removeChild(this.source[e]),this.source[e].includeInLayout=!0,this.source[e].s_size(),e){case 0:this.source1.addChild(this.source[e]);break;case 1:this.source2.addChild(this.source[e]);break;case 2:this.source3.addChild(this.source[e]);break;default:return}},i.prototype.erase_b_field_once=function(t,i){for(var r=0;4>r;r++)for(var n=0;n<9-t.size[0].y+1;n++)for(var o=0;o<9-t.size[0].x+1;o++)if(1==t.match_b_field(this.b,n,o,this.shade_b,i,e.GlobalArg.color[r])){this.dp_new(Math.floor(Math.pow(1.3,this.clevel)*(t.d[0].y+this.clevel)*this.mult).toString()),this.cscore+=Math.floor(Math.pow(1.3,this.clevel)*(t.d[0].y+this.clevel)*this.mult),this.score.text=this.cscore.toString();var s=0;for(s=0;s<e.GlobalArg.level_score.length&&!(e.GlobalArg.level_score[s]>this.cscore);s++);return this.clevel<s&&(this.clevel=s,egret.Tween.get(this.level).to({text:this.clevel.toString(),scaleX:1,scaleY:1},50,egret.Ease.sineIn).to({scaleX:.43,scaleY:.43},300,egret.Ease.sineIn)),this.mult++,!0}return!1},i.prototype.erase_b_field_timer=function(){if(this.target1.numChildren>0){if(1==this.erase_b_field_once(this.target1.getChildAt(0),this.plex1))return void this.plex1++;this.plex1>0&&(this.plex1=0,this.target1.removeChildren())}if(this.target2.numChildren>0){if(1==this.erase_b_field_once(this.target2.getChildAt(0),this.plex2))return void this.plex2++;this.plex2>0&&(this.plex2=0,this.target2.removeChildren())}if(this.target3.numChildren>0){if(1==this.erase_b_field_once(this.target3.getChildAt(0),this.plex3))return void this.plex3++;this.plex3>0&&(this.plex3=0,this.target3.removeChildren())}if(this.target4.numChildren>0){if(1==this.erase_b_field_once(this.target4.getChildAt(0),this.plex4))return void this.plex4++;this.plex4>0&&(this.plex4=0,this.target4.removeChildren())}return 0==this.target1.numChildren||0==this.target2.numChildren||0==this.target3.numChildren||0==this.target4.numChildren?(this.set_target(),void this.clean_b_field()):(this.timer.stop(),this.mult=1,this.clean_b_field(),this.set_source(),0==this.check_b_field()?void this.show_top():void(this.touchEnabled=!0))},i.prototype.erase_b_field=function(){this.timer.start()},i.prototype.check_source_field=function(e,t){for(var i=0;3>i;i++)null!=this.source[i]&&e>=this.slx[i]&&e<=this.srx[i]&&t>=this.sty[i]&&t<=this.sby[i]&&(this.cidx=i,this.release_source(i),this.rx=Math.floor((this.ax-this.slx[i])*this.source[i].size[1].x/this.source[i].size[2].x),this.ry=Math.floor((this.ay-this.sty[i])*this.source[i].size[1].y/this.source[i].size[2].y),this.source[i].x=this.ax-this.rx,this.source[i].y=this.ay-this.ry,this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touch_move,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touch_end,this))},i.prototype.check_b_field_once=function(e){for(var t=0;t<9-e.size[0].y+1;t++)for(var i=0;i<9-e.size[0].x+1;i++)if(e.match_b_field(this.b,t,i,null,0))return!0;return!1},i.prototype.check_b_field=function(){return this.source1.numChildren>0&&1==this.check_b_field_once(this.source1.getChildAt(0))?!0:this.source2.numChildren>0&&1==this.check_b_field_once(this.source2.getChildAt(0))?!0:this.source3.numChildren>0&&1==this.check_b_field_once(this.source3.getChildAt(0))?!0:!1},i.prototype.clean_b_field=function(){for(var e=0;9>e;e++)for(var t=0;9>t;t++)this.shade_b[e][t].alpha>0&&(this.shade_b[e][t].alpha=0,this.b[e][t].currentState="empty")},i.prototype.set_b_field=function(e){for(var t=this.cb.length-1;t>=0;t--)this.cb.splice(t,1);this.removeChild(e),e.includeInLayout=!0,e.s_size(),e.alpha=1,e.x=0,e.y=0},i.prototype.restore_b_field=function(e){for(var t=this.cb.length-1;t>=0;t--)this.cb[t].currentState="empty",this.cb.splice(t,1);e.alpha=1},i.prototype.match_b_field=function(e){for(var t=0;t<9-e.size[0].y+1;t++)for(var i=0;i<9-e.size[0].x+1;i++)if(e.x>=this.b[t][i].localToGlobal().x&&e.x<=this.b[t][i].localToGlobal().x+this.b[t][i].width&&e.y>=this.b[t][i].localToGlobal().y&&e.y<=this.b[t][i].localToGlobal().y+this.b[t][i].height&&e.match_b_field(this.b,t,i,this.cb,1))return void(e.alpha=0);this.restore_b_field(e)},i.prototype.touch_on=function(){this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touch_begin,this)},i.prototype.touch_begin=function(e){e.type==egret.TouchEvent.TOUCH_BEGIN&&(this.set_source_field(),this.ax=e.stageX,this.ay=e.stageY,this.check_source_field(e.stageX,e.stageY))},i.prototype.touch_move=function(e){if(e.type==egret.TouchEvent.TOUCH_MOVE){if(null==this.source[this.cidx])return void this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touch_move,this);this.source[this.cidx].x=e.stageX-this.rx,this.source[this.cidx].y=e.stageY-this.ry,this.match_b_field(this.source[this.cidx])}},i.prototype.touch_end=function(e){if(e.type==egret.TouchEvent.TOUCH_END){if(this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touch_move,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.touch_end,this),this.touchEnabled=!1,null==this.source[this.cidx])return;this.rx=0,this.ry=0,this.ax=0,this.ay=0,0==this.source[this.cidx].alpha?(this.set_b_field(this.source[this.cidx]),this.erase_b_field()):(this.restore_b_field(this.source[this.cidx]),this.insert_source(this.cidx),this.source[this.cidx].x=0,this.source[this.cidx].y=0),this.cidx=3}},i.prototype.get_random_src=function(){for(var e=100*Math.random(),t=0;t<this.patsrc.length;t++){if(!(e>=this.patsrc[t].d[0].x))return this.patsrc[t];e-=this.patsrc[t].d[0].x}return this.patsrc[t-1]},i.prototype.get_random_tgt=function(){for(var e=100*Math.random(),t=0;t<this.pattgt.length;t++){if(!(e>=this.pattgt[t].d[0].x))return this.pattgt[t];e-=this.pattgt[t].d[0].x}return this.pattgt[t-1]},i.prototype.set_source=function(){if(0==this.source1.numChildren)for(;;){var e=this.get_random_src();if(!(0!=this.source2.numChildren&&this.source2.getChildAt(0)==e||0!=this.source3.numChildren&&this.source3.getChildAt(0)==e)){e.random_color(this.clevel),this.source1.addChild(e);break}}if(0==this.source2.numChildren)for(;;){var e=this.get_random_src();if((0!=this.source1.numChildren&&this.source1.getChildAt(0))!=e&&(0==this.source3.numChildren||this.source3.getChildAt(0)!=e)){e.random_color(this.clevel),this.source2.addChild(e);break}}if(0==this.source3.numChildren)for(;;){var e=this.get_random_src();if((0!=this.source1.numChildren&&this.source1.getChildAt(0))!=e&&(0==this.source2.numChildren||this.source2.getChildAt(0)!=e)){e.random_color(this.clevel),this.source3.addChild(e);break}}},i.prototype.set_target=function(){if(0==this.target1.numChildren)for(;;){var e=this.get_random_tgt();if(!(0!=this.target2.numChildren&&this.target2.getChildAt(0)==e||0!=this.target3.numChildren&&this.target3.getChildAt(0)==e||0!=this.target4.numChildren&&this.target4.getChildAt(0)==e)){e.random_color(this.clevel),this.target1.addChild(e);break}}if(0==this.target2.numChildren)for(;;){var e=this.get_random_tgt();if(!(0!=this.target1.numChildren&&this.target1.getChildAt(0)==e||0!=this.target3.numChildren&&this.target3.getChildAt(0)==e||0!=this.target4.numChildren&&this.target4.getChildAt(0)==e)){e.random_color(this.clevel),this.target2.addChild(e);break}}if(0==this.target3.numChildren)for(;;){var e=this.get_random_tgt();if(!(0!=this.target1.numChildren&&this.target1.getChildAt(0)==e||0!=this.target2.numChildren&&this.target2.getChildAt(0)==e||0!=this.target4.numChildren&&this.target4.getChildAt(0)==e)){e.random_color(this.clevel),this.target3.addChild(e);break}}if(0==this.target4.numChildren)for(;;){var e=this.get_random_tgt();if(!(0!=this.target1.numChildren&&this.target1.getChildAt(0)==e||0!=this.target2.numChildren&&this.target2.getChildAt(0)==e||0!=this.target3.numChildren&&this.target3.getChildAt(0)==e)){e.random_color(this.clevel),this.target4.addChild(e);break}}},i.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},i}(eui.Component);e.Base=t,__reflect(t.prototype,"Cube.Base",["eui.UIComponent","egret.DisplayObject"])}(Cube||(Cube={}));var Cube;!function(e){var t=function(){function e(){}return e.color=["red","blue","yellow","green","base","empty","match"],e.bsize=new egret.Point(66,66),e.ssize=new egret.Point(40,40),e.tsize=new egret.Point(25,25),e.patsrc=[[new egret.Point(8,0),new egret.Point(0,0)],[new egret.Point(8,0),new egret.Point(0,0),new egret.Point(1,0)],[new egret.Point(8,0),new egret.Point(0,0),new egret.Point(0,1)],[new egret.Point(5,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,1)],[new egret.Point(5,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(0,1)],[new egret.Point(5,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(1,1)],[new egret.Point(5,0),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1)],[new egret.Point(2,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,0),new egret.Point(1,1)],[new egret.Point(3,0),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(1,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,0),new egret.Point(1,1)],[new egret.Point(3,0),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(1,2)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(1,2)],[new egret.Point(3,0),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(0,2)],[new egret.Point(3,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(0,1),new egret.Point(1,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,0),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(0,2),new egret.Point(1,2)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(0,2)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(2,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(0,2),new egret.Point(1,2)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(0,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(1,2)],[new egret.Point(3,0),new egret.Point(2,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(3,0)],[new egret.Point(3,0),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(0,2),new egret.Point(0,3)]],e.pattgt=[[new egret.Point(5,50),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,1)],[new egret.Point(5,50),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(0,1)],[new egret.Point(5,50),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(1,1)],[new egret.Point(5,50),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1)],[new egret.Point(2,50),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,0),new egret.Point(1,1)],[new egret.Point(3,100),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(1,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,0),new egret.Point(1,1)],[new egret.Point(3,100),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(1,2)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(1,2)],[new egret.Point(3,100),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(0,2)],[new egret.Point(3,100),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(0,1),new egret.Point(1,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,100),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(0,2),new egret.Point(1,2)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(0,2)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(2,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(0,2),new egret.Point(1,2)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(0,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(1,2)],[new egret.Point(3,100),new egret.Point(2,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(1,0),new egret.Point(2,0),new egret.Point(3,0)],[new egret.Point(3,100),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(0,2),new egret.Point(0,3)],[new egret.Point(8,200),new egret.Point(0,0),new egret.Point(0,1),new egret.Point(0,2),new egret.Point(1,0),new egret.Point(1,1),new egret.Point(1,2),new egret.Point(2,0),new egret.Point(2,1),new egret.Point(2,2)],[new egret.Point(8,200),new egret.Point(1,0),new egret.Point(0,1),new egret.Point(1,1),new egret.Point(2,1),new egret.Point(1,2)],[new egret.Point(8,200),new egret.Point(0,0),new egret.Point(2,0),new egret.Point(1,1),new egret.Point(0,2),new egret.Point(2,2)]],e.level_score=[253,434,657,943,1322,1843,2577,3632,5171,7443,10822,15876,23461,34876,52083,78050,117265,176515,266065,401431,606075,915467,1383226,2090406,3159521,4775747,7218950,10912089,16494332,24931538,37683144,56954289,86076646,130083681,196579522,297051256,448850855,678188293,1024651549,1548032125,2338631567,3532823641,5336551160,8060801598,12175166035,18388695907,27771965585,41941332451,63337076322,95643232532],e}();e.GlobalArg=t,__reflect(t.prototype,"Cube.GlobalArg")}(Cube||(Cube={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},t.prototype.onResourceLoadComplete=function(e){"preload"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"preload"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.startCreateScene=function(){var e=new eui.UILayer,t=new Cube.Base;e.addChild(t),this.addChild(e),t.set_source(),t.set_target()},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.prototype.startAnimation=function(e){var t=this,i=new egret.HtmlTextParser,r=e.map(function(e){return i.parse(e)}),n=this.textfield,o=-1,s=function(){o++,o>=r.length&&(o=0);var e=r[o];n.textFlow=e;var i=egret.Tween.get(n);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(s,t)};s()},t.prototype.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.UILayer);__reflect(Main.prototype,"Main");var Cube;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName="recordSkin",t.horizontalCenter="0",t.submit.addEventListener(egret.TouchEvent.TOUCH_TAP,t.send_record,t),t}return __extends(t,e),t.prototype.send_record=function(){this.submit.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.send_record,this),this.submit.touchEnabled=!1,this.submit.alpha=0,this.nick.touchEnabled=!1,this.nick.textDisplay.touchEnabled=!1,this.desc.touchEnabled=!1,this.desc.width=460,this.desc.textDisplay.touchEnabled=!1;var e='data={"n":'+this.nick.text+',"l":'+this.level.text+',"s":'+this.score.text+',"d":'+this.desc.text+"}",t=new egret.HttpRequest;t.responseType=egret.HttpResponseType.TEXT,t.open("put.do",egret.HttpMethod.POST),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(e)},t}(eui.Component);e.Record=t,__reflect(t.prototype,"Cube.Record",["eui.UIComponent","egret.DisplayObject"])}(Cube||(Cube={}));var Cube;!function(e){var t=function(t){function i(i){var r=t.call(this)||this;r.d=null,r.size=[new egret.Point,new egret.Point,new egret.Point],r.g=new eui.Group,r.c=[],r.d=i,r.g.percentWidth=100,r.g.percentHeight=100,r.g.top=0,r.g.left=0,r.addChild(r.g);for(var n=1;n<r.d.length;n++)r.size[0].x<r.d[n].x&&(r.size[0].x=r.d[n].x),r.size[0].y<r.d[n].y&&(r.size[0].y=r.d[n].y);r.size[0].x++,r.size[0].y++,r.size[1].x=r.size[0].x*e.GlobalArg.bsize.x,r.size[1].y=r.size[0].y*e.GlobalArg.bsize.y,r.size[2].x=r.size[0].x*e.GlobalArg.ssize.x,r.size[2].y=r.size[0].y*e.GlobalArg.ssize.y;for(var n=0;n<r.d.length-1;n++)r.c[n]=new e.ResCube,r.c[n].skinName="ResCubeSkin",r.c[n].currentState="base",r.c[n].percentWidth=100/r.size[0].x,r.c[n].percentHeight=100/r.size[0].y,r.c[n].left=r.c[n].percentWidth*r.d[n+1].x+"%",r.c[n].top=r.c[n].percentHeight*r.d[n+1].y+"%",r.c[n].touchEnabled=!1,r.g.addChild(r.c[n]);return r.horizontalCenter=0,r.verticalCenter=0,r.touchEnabled=!1,r.s_size(),r}return __extends(i,t),i.prototype.b_size=function(){this.width=this.size[1].x,this.height=this.size[1].y},i.prototype.s_size=function(){this.width=this.size[2].x,this.height=this.size[2].y},i.prototype.restore_b_field=function(e){for(var t=e.length-1;t>=0;t--)e[t].currentState="empty",e.splice(t,1)},i.prototype.match_b_field=function(e,t,i,r,n){if(null!=r&&r.length>0)if(r.length!=this.d.length-1)this.restore_b_field(r);else{for(var o=0;o<this.d.length-1;o++)if(r[o]!=e[t+this.d[o+1].y][i+this.d[o+1].x]){this.restore_b_field(r);break}if(r.length>0)return!0}for(var o=1;o<this.d.length;o++)if("empty"!=e[t+this.d[o].y][i+this.d[o].x].currentState)return!1;if(0==n)return!0;for(var o=0;o<this.d.length-1;o++)e[t+this.d[o+1].y][i+this.d[o+1].x].currentState=this.c[o].currentState,r[o]=e[t+this.d[o+1].y][i+this.d[o+1].x];return!0},i.prototype.random_color=function(t){var i=0;i=1>=t?2:5>=t?2:10>=t?3:4;for(var r=0;r<this.d.length-1;r++)this.c[r].currentState=e.GlobalArg.color[Math.floor(Math.random()*i)]},i.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},i}(eui.Component);e.S=t,__reflect(t.prototype,"Cube.S",["eui.UIComponent","egret.DisplayObject"])}(Cube||(Cube={}));var Cube;!function(e){var t=function(t){function i(i){var r=t.call(this)||this;r.d=null,r.size=[new egret.Point,new egret.Point,new egret.Point],r.g=new eui.Group,r.c=[],r.d=i,r.g.percentWidth=100,r.g.percentHeight=100,r.g.top=0,r.g.left=0,r.addChild(r.g);for(var n=1;n<r.d.length;n++)r.size[0].x<r.d[n].x&&(r.size[0].x=r.d[n].x),r.size[0].y<r.d[n].y&&(r.size[0].y=r.d[n].y);r.size[0].x++,r.size[0].y++,r.size[1].x=r.size[0].x*e.GlobalArg.bsize.x,r.size[1].y=r.size[0].y*e.GlobalArg.bsize.y,r.size[2].x=r.size[0].x*e.GlobalArg.tsize.x,r.size[2].y=r.size[0].y*e.GlobalArg.tsize.y;for(var n=0;n<r.d.length-1;n++)r.c[n]=new e.ResCube,r.c[n].skinName="ResCubeSkin",r.c[n].currentState="base",r.c[n].percentWidth=100/r.size[0].x,r.c[n].percentHeight=100/r.size[0].y,r.c[n].left=r.c[n].percentWidth*r.d[n+1].x+"%",r.c[n].top=r.c[n].percentHeight*r.d[n+1].y+"%",r.c[n].touchEnabled=!1,r.g.addChild(r.c[n]);return r.horizontalCenter=0,r.verticalCenter=0,r.touchEnabled=!1,r.s_size(),r}return __extends(i,t),i.prototype.b_size=function(){this.width=this.size[1].x,this.height=this.size[1].y},i.prototype.s_size=function(){this.width=this.size[2].x,this.height=this.size[2].y},i.prototype.match_b_field=function(e,t,i,r,n,o){for(var s=1;s<this.d.length;s++)if("empty"==e[t+this.d[s].y][i+this.d[s].x].currentState)return!1;if(n>0)for(var s=1;s<this.d.length;s++)if(r[t+this.d[s].y][i+this.d[s].x].alpha>0)return!1;for(var s=0;s<this.d.length-1;s++){if("base"!=this.c[s].currentState&&e[t+this.d[s+1].y][i+this.d[s+1].x].currentState!=this.c[s].currentState)return!1;if("base"==this.c[s].currentState&&e[t+this.d[s+1].y][i+this.d[s+1].x].currentState!=o)return!1}for(var s=1;s<this.d.length;s++)egret.Tween.get(r[t+this.d[s].y][i+this.d[s].x]).to({alpha:1},50,egret.Ease.sineIn).to({alpha:.8},50,egret.Ease.sineIn);return!0},i.prototype.random_color=function(t){var i=0;i=20>=t?0:23>=t?1:26>=t?2:30>=t?3:4;for(var r=0;r<this.d.length-1;r++)"base"!=this.c[r].currentState&&(this.c[r].currentState="base");for(;i>0;i--){for(var n=Math.floor(Math.random()*(this.d.length-1));"base"!=this.c[n].currentState;)n++,n>=i&&(n=0);this.c[n].currentState=e.GlobalArg.color[Math.floor(Math.random()*i)]}},i.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},i.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},i}(eui.Component);e.T=t,__reflect(t.prototype,"Cube.T",["eui.UIComponent","egret.DisplayObject"])}(Cube||(Cube={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,i,r){function n(e){t.call(r,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(r))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);